package com.example.kafka;

import com.jd.coo.x.tc.client.resful.dto.ob.task.ObEmptyTrayDto;
import org.assertj.core.util.Lists;

import java.util.*;

public class KafkaApplication {


    public static void initJdCoordinate(String points) {
        // 地图服务虚拟化最初点
        Integer initX = 1001;
        Integer initY = 1003;
        Map<Double, Integer> xMap = new HashMap<>();
        List<Double> xs = new ArrayList<>();
        Map<Double, Integer> yMap = new HashMap<>();
        List<Double> ys = new ArrayList<>();
        List<String> pointList = Lists.newArrayList(points.split(";"));
        for (String s : pointList) {
            xs.add(Double.valueOf(s.split(",")[0]));
            ys.add(Double.valueOf(s.split(",")[1]));
        }
        Set<Double> xSet = new HashSet<>(xs);
        xs = new ArrayList<>(xSet);
        Collections.sort(xs, Comparator.comparing(Double::valueOf));

        Integer lastXNum = 0;
        for (int i = 0; i < xs.size(); i++) {
            if (xMap.get(xs.get(i)) == null) {

                xMap.put(xs.get(i), lastXNum);
                lastXNum += 1;
            }
        }
        Set<Double> ySet = new HashSet<>(ys);
        ys = new ArrayList<>(ySet);
        Collections.sort(ys, Comparator.comparing(Double::valueOf));
        Integer lastYNum = 0;
        for (int i = 0; i < ys.size(); i++) {
            if (yMap.get(ys.get(i)) == null) {
                yMap.put(ys.get(i), lastYNum);
                lastYNum += 1;
            }
        }
        String sql = "INSERT INTO `jdx_aw_wcs`.`aw_point_config` ( `coordinate_x`, `coordinate_y`, `jd_coordinate`, `create_time`, `create_user`, `is_delete`, `ts`, `update_time`, `update_user`, `distribute_no`, `map_no`, `org_no`, `warehouse_no`) VALUES ('%s', '%s', '%s','2021-03-19', 'JDX', '0', NULL, '2021-03-19', 'JDX', '8', '888', '8', '8');";
        for (int i = 0; i < pointList.size(); i++) {
            String[] split = pointList.get(i).split(",");
            System.out.println(String.format(sql, split[0], split[1], (initX + xMap.get(Double.valueOf(split[0]))) + "" + (initY + yMap.get(Double.valueOf(split[1])))));
        }

    }


    public static void main(String[] args) {

        String point = "3.08,5.44;3.08,9.53;3.08,16.26;3.08,20.68;3.69,5.44;3.69,9.53;3.69,16.26;3.69,20.68;3.69,22.72;3.69,24.59;3.69,26.49;3.95,5.44;3.95,9.53;3.95,16.26;3.95,20.68;3.95,22.72;3.95,24.59;3.95,26.49;4.18,5.44;4.18,9.53;4.18,16.26;4.18,20.68;4.18,22.72;4.18,24.59;4.18,26.49;4.55,3.35;4.55,4.39;4.55,5.44;4.55,6.33;4.55,7.12;4.55,7.92;4.55,8.15;4.55,8.73;4.55,9.18;4.55,9.53;4.55,10.22;4.55,11.24;4.55,12.27;4.55,13.29;4.55,14.32;4.55,15.29;4.55,16.26;4.55,17.15;4.55,18.09;4.55,18.95;4.55,19.81;4.55,20.4;4.55,20.68;4.55,21.7;4.55,22.72;4.55,23.65;4.55,24.59;4.55,25.54;4.55,26.49;5.17,3.35;5.17,7.12;5.17,10.22;5.17,14.32;5.17,18.09;5.17,22.72;5.17,24.59;5.17,26.49;5.8,3.35;5.8,7.12;5.8,10.22;5.8,14.32;5.8,18.09;5.8,22.72;5.8,23.65;5.8,24.59;5.8,25.54;5.8,26.49;6.03,3.35;6.03,4.39;6.03,5.44;6.03,6.33;6.03,7.12;6.03,7.92;6.03,8.15;6.03,8.73;6.03,9.18;6.03,9.53;6.03,10.22;6.03,11.24;6.03,12.27;6.03,13.29;6.03,14.32;6.03,15.29;6.03,16.26;6.03,17.15;6.03,18.09;6.03,18.95;6.03,19.81;6.03,20.4;6.03,20.68;6.03,21.7;6.03,22.72;6.03,23.65;6.03,24.59;6.03,25.54;6.03,26.49;6.35,3.35;6.35,7.12;6.35,10.22;6.35,14.32;6.35,18.09;6.35,22.72;6.35,26.49;6.76,3.35;6.76,7.12;6.76,10.22;6.76,14.32;6.76,18.09;6.76,22.72;6.76,26.49;7.3,3.35;7.3,7.12;7.3,10.22;7.3,14.32;7.3,18.09;7.3,22.72;7.3,26.49;7.54,3.35;7.54,7.12;7.54,10.22;7.54,14.32;7.54,18.09;7.54,22.72;7.54,26.49;7.84,3.35;7.84,7.12;7.84,10.22;7.84,14.32;7.84,18.09;7.84,22.72;7.84,26.49;8.08,3.35;8.08,7.12;8.08,10.22;8.08,14.32;8.08,18.09;8.08,22.72;8.08,26.49;8.38,3.35;8.38,7.12;8.38,10.22;8.38,14.32;8.38,18.09;8.38,22.72;8.38,26.49;8.62,3.35;8.62,7.12;8.62,10.22;8.62,14.32;8.62,18.09;8.62,22.72;8.62,26.49;9.11,3.35;9.11,7.12;9.11,10.22;9.11,14.32;9.11,18.09;9.11,22.72;9.11,26.49;9.16,3.35;9.16,7.12;9.16,10.22;9.16,14.32;9.16,18.09;9.16,22.72;9.16,26.49;9.65,3.35;9.65,7.12;9.65,10.22;9.65,14.32;9.65,18.09;9.65,22.72;9.65,26.49;9.9,3.35;9.9,7.12;9.9,10.22;9.9,14.32;9.9,18.09;9.9,22.72;9.9,26.49;10.19,3.35;10.19,7.12;10.19,10.22;10.19,14.32;10.19,18.09;10.19,22.72;10.19,26.49;10.44,3.35;10.44,7.12;10.44,10.22;10.44,14.32;10.44,18.09;10.44,22.72;10.44,26.49;10.73,3.35;10.73,7.12;10.73,10.22;10.73,14.32;10.73,18.09;10.73,22.72;10.73,26.49;10.98,3.35;10.98,7.12;10.98,10.22;10.98,14.32;10.98,18.09;10.98,22.72;10.98,26.49;11.47,3.35;11.47,7.12;11.47,10.22;11.47,14.32;11.47,18.09;11.47,22.72;11.47,26.49;11.52,3.35;11.52,7.12;11.52,10.22;11.52,14.32;11.52,18.09;11.52,22.72;11.52,26.49;12.01,3.35;12.01,7.12;12.01,10.22;12.01,14.32;12.01,18.09;12.01,22.72;12.01,26.49;12.25,3.35;12.25,7.12;12.25,10.22;12.25,14.32;12.25,18.09;12.25,22.72;12.25,26.49;12.55,3.35;12.55,7.12;12.55,10.22;12.55,14.32;12.55,18.09;12.55,22.72;12.55,26.49;12.79,3.35;12.79,7.12;12.79,10.22;12.79,14.32;12.79,18.09;12.79,22.72;12.79,26.49;13.09,3.35;13.09,7.12;13.09,10.22;13.09,14.32;13.09,18.09;13.09,22.72;13.09,26.49;13.33,3.35;13.33,7.12;13.33,10.22;13.33,14.32;13.33,18.09;13.33,22.72;13.33,26.49;13.82,3.35;13.82,7.12;13.82,10.22;13.82,14.32;13.82,18.09;13.82,22.72;13.82,26.49;13.87,3.35;13.87,7.12;13.87,10.22;13.87,14.32;13.87,18.09;13.87,22.72;13.87,26.49;14.36,3.35;14.36,7.12;14.36,10.22;14.36,14.32;14.36,18.09;14.36,22.72;14.36,26.49;14.61,3.35;14.61,7.12;14.61,10.22;14.61,14.32;14.61,18.09;14.61,22.72;14.61,26.49;14.9,3.35;14.9,7.12;14.9,10.22;14.9,14.32;14.9,18.09;14.9,22.72;14.9,26.49;15.15,3.35;15.15,7.12;15.15,10.22;15.15,14.32;15.15,18.09;15.15,22.72;15.15,26.49;15.44,3.35;15.44,7.12;15.44,10.22;15.44,14.32;15.44,18.09;15.44,22.72;15.44,26.49;15.69,3.35;15.69,7.12;15.69,10.22;15.69,14.32;15.69,18.09;15.69,22.72;15.69,26.49;16.18,3.35;16.18,7.12;16.18,10.22;16.18,14.32;16.18,18.09;16.18,22.72;16.18,26.49;16.23,3.35;16.23,7.12;16.23,10.22;16.23,14.32;16.23,18.09;16.23,22.72;16.23,26.49;16.72,3.35;16.72,7.12;16.72,10.22;16.72,14.32;16.72,18.09;16.72,22.72;16.72,26.49;16.96,3.35;16.96,7.12;16.96,10.22;16.96,14.32;16.96,18.09;16.96,22.72;16.96,26.49;17.26,3.35;17.26,7.12;17.26,10.22;17.26,14.32;17.26,18.09;17.26,22.72;17.26,26.49;17.5,3.35;17.5,7.12;17.5,10.22;17.5,14.32;17.5,18.09;17.5,22.72;17.5,26.49;17.8,3.35;17.8,7.12;17.8,10.22;17.8,14.32;17.8,18.09;17.8,22.72;17.8,26.49;18.04,3.35;18.04,7.12;18.04,10.22;18.04,14.32;18.04,18.09;18.04,22.72;18.04,26.49;18.53,3.35;18.53,7.12;18.53,10.22;18.53,14.32;18.53,18.09;18.53,22.72;18.53,26.49;18.58,3.35;18.58,7.12;18.58,10.22;18.58,14.32;18.58,18.09;18.58,22.72;18.58,26.49;19.07,3.35;19.07,7.12;19.07,10.22;19.07,14.32;19.07,18.09;19.07,22.72;19.07,26.49;19.32,3.35;19.32,7.12;19.32,10.22;19.32,14.32;19.32,18.09;19.32,22.72;19.32,26.49;19.61,3.35;19.61,7.12;19.61,10.22;19.61,14.32;19.61,18.09;19.61,22.72;19.61,26.49;19.86,3.35;19.86,7.12;19.86,10.22;19.86,14.32;19.86,18.09;19.86,22.72;19.86,26.49;20.4,3.35;20.4,7.12;20.4,10.22;20.4,14.32;20.4,18.09;20.4,22.72;20.4,26.49;20.74,3.35;20.74,7.12;20.74,10.22;20.74,14.32;20.74,18.09;20.74,22.72;20.74,26.49;21.28,3.35;21.28,4.39;21.28,5.44;21.28,6.33;21.28,7.12;21.28,7.92;21.28,8.15;21.28,8.73;21.28,9.18;21.28,9.53;21.28,10.22;21.28,11.24;21.28,12.27;21.28,13.29;21.28,14.32;21.28,15.29;21.28,16.26;21.28,17.15;21.28,18.09;21.28,18.95;21.28,19.81;21.28,20.4;21.28,20.68;21.28,21.7;21.28,22.72;21.28,23.65;21.28,24.59;21.28,25.54;21.28,26.49;21.58,7.12;21.58,10.22;21.58,14.32;21.58,18.09;21.58,22.72;21.58,26.49;22.17,7.12;22.17,10.22;22.17,14.32;22.17,18.09;22.17,22.72;22.17,26.49;22.71,7.12;22.71,10.22;22.71,14.32;22.71,18.09;22.71,22.72;22.71,26.49;22.95,7.12;22.95,10.22;22.95,14.32;22.95,18.09;22.95,22.72;22.95,26.49;23.44,7.12;23.44,10.22;23.44,14.32;23.44,18.09;23.44,22.72;23.44,26.49;23.49,7.12;23.49,10.22;23.49,14.32;23.49,18.09;23.49,22.72;23.49,26.49;23.98,7.12;23.98,10.22;23.98,14.32;23.98,18.09;23.98,22.72;23.98,26.49;24.23,7.12;24.23,10.22;24.23,14.32;24.23,18.09;24.23,22.72;24.23,26.49;24.52,7.12;24.52,10.22;24.52,14.32;24.52,18.09;24.52,22.72;24.52,26.49;24.77,7.12;24.77,10.22;24.77,14.32;24.77,18.09;24.77,22.72;24.77,26.49;25.06,7.12;25.06,10.22;25.06,14.32;25.06,18.09;25.06,22.72;25.06,26.49;25.31,7.12;25.31,10.22;25.31,14.32;25.31,18.09;25.31,22.72;25.31,26.49;25.8,7.12;25.8,10.22;25.8,14.32;25.8,18.09;25.8,22.72;25.8,26.49;25.85,7.12;25.85,10.22;25.85,14.32;25.85,18.09;25.85,22.72;25.85,26.49;26.34,7.12;26.34,10.22;26.34,14.32;26.34,18.09;26.34,22.72;26.34,26.49;26.58,7.12;26.58,10.22;26.58,14.32;26.58,18.09;26.58,22.72;26.58,26.49;26.88,7.12;26.88,10.22;26.88,14.32;26.88,18.09;26.88,22.72;26.88,26.49;27.12,7.12;27.12,10.22;27.12,14.32;27.12,18.09;27.12,22.72;27.12,26.49;27.42,7.12;27.42,10.22;27.42,14.32;27.42,18.09;27.42,22.72;27.42,26.49;27.66,7.12;27.66,10.22;27.66,14.32;27.66,18.09;27.66,22.72;27.66,26.49;28.15,7.12;28.15,10.22;28.15,14.32;28.15,18.09;28.15,22.72;28.15,26.49;28.2,7.12;28.2,10.22;28.2,14.32;28.2,18.09;28.2,22.72;28.2,26.49;28.69,7.12;28.69,10.22;28.69,14.32;28.69,18.09;28.69,22.72;28.69,26.49;28.94,7.12;28.94,10.22;28.94,14.32;28.94,18.09;28.94,22.72;28.94,26.49;29.23,7.12;29.23,10.22;29.23,14.32;29.23,18.09;29.23,22.72;29.23,26.49;29.48,7.12;29.48,10.22;29.48,14.32;29.48,18.09;29.48,22.72;29.48,26.49;29.77,7.12;29.77,10.22;29.77,14.32;29.77,18.09;29.77,22.72;29.77,26.49;30.02,7.12;30.02,10.22;30.02,14.32;30.02,18.09;30.02,22.72;30.02,26.49;30.51,7.12;30.51,10.22;30.51,14.32;30.51,18.09;30.51,22.72;30.51,26.49;30.56,7.12;30.56,10.22;30.56,14.32;30.56,18.09;30.56,22.72;30.56,26.49;31.05,7.12;31.05,10.22;31.05,14.32;31.05,18.09;31.05,22.72;31.05,26.49;31.29,7.12;31.29,10.22;31.29,14.32;31.29,18.09;31.29,22.72;31.29,26.49;31.59,7.12;31.59,10.22;31.59,14.32;31.59,18.09;31.59,22.72;31.59,26.49;31.83,7.12;31.83,10.22;31.83,14.32;31.83,18.09;31.83,22.72;31.83,26.49;32.13,7.12;32.13,10.22;32.13,14.32;32.13,18.09;32.13,22.72;32.13,26.49;32.37,7.12;32.37,10.22;32.37,14.32;32.37,18.09;32.37,22.72;32.37,26.49;32.91,7.12;32.91,10.22;32.91,14.32;32.91,18.09;32.91,22.72;32.91,26.49;33.19,7.12;33.19,10.22;33.19,14.32;33.19,18.09;33.19,22.72;33.19,26.49;33.72,7.12;33.72,7.92;33.72,8.15;33.72,8.73;33.72,9.18;33.72,9.53;33.72,10.22;33.72,11.24;33.72,12.27;33.72,13.29;33.72,14.32;33.72,15.29;33.72,16.26;33.72,17.15;33.72,18.09;33.72,22.72;33.72,23.65;33.72,24.59;33.72,25.54;33.72,26.49;";
        initJdCoordinate(point);

    }

}
